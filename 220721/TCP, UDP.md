# TCP, UDP

IP 프로토콜에서 발생된 문제들 `ex) 순서 꼬이거나, 패킷 소실`

해결 할 수 있다.

### 인터넷 프로토콜 스택의 4계층

- 애플리케이션 계층 - HTTP, FTP
- 전송 계층 - TCP, UDP
- 인터넷 계층 - IP
- 네트워크 인터페이스 계층

**IP를 살짝만 위의 TCP, UDP에 올려서 보완해준다고 생각하면 좋다!**

ex) 미국에 있는 친구한테 “Hello, world!”를 보내보고자 한다면,

![Untitled](TCP,%20UDP%208e14485f93f84101846051df64dfc9f6/Untitled.png)

보통 SOCKET 라이브러리를 많이 사용한다.

SOCKET 라이브러리는 OS에 메시지를 넘긴다.

OS계층에다 넘긴후엔  OS계층에서 TCP는 Hello라는 메시지에 TCP 정보를 하나 씌운다

그리고 한칸 더 내린다. IP정보를 하나 씌운다.

따라서 패킷은 IP 정보가 있고, 그 안에 TCP 정보가 하나 있고, 그 안에 메시지가 있다.

이 것이 네트워크 인터페이스, LAN 카드를 통해서 나갈때 ethernet frame을 통해서 나간다. 

패킷은 package + bucket의 합성어이다.

![Untitled](TCP,%20UDP%208e14485f93f84101846051df64dfc9f6/Untitled%201.png)

전송 제어, 순서, 검증 정보등등을 넣어 IP로만 해결되지 못했던 문제들을 해결할 수 있다. 

## TCP 특징

**Transmission Control Protocol = 전송 제어 프로토콜**

전송을 어떻게 할지 제어한다는 말

크게 3가지 특징

- `연결지향` - 연결이 됐나 안됐나 확인 후에 보냄
- `데이터 전달 보증` - 중간에 누락되면 알 수 있음
- `순서 보장`

→ 신뢰할 수 있는 프로토콜

**현재는 대부분 애플리케이션에서 TCP를 사용!**

### TCP 3 way handshake (가상 연결)

1. SYN : 클라이언트 → 서버로 연결 요청을 보냄
2. SYN + ACK : 서버→ 클라이언트로 요청 수락을 하며, 연결 요청을 보냄
3. ACK : 클라이언트→ 서버 요청 수락을 함
4. 연결이 된 후에 데이터 전송

**TCP 3 way handshake는 논리적 연결이 된 것! 실제 연결은 아니에요!** 

### 데이터 전달 보증

→TCP가 붙으면 **“나 데이터 잘 받았어” 라고 응답을 하게 되어있음**

### 순서 보장

→ 패킷 1, 2, 3 순서로 받았는데 만약 1, 3, 2 순서로 도착했다면

서버가 다시 요청함. **“2부터 다시보내”**

<aside>
✅ 이게 그냥 되는게 아니라
**전송 제어, 순서, 검증 정보 등등이 TCP 안에 들어가 있기 때문에!**

</aside>

UDP는 TCP 와 마찬가지로 OS안에서 IP바로 위에 있는 프로토콜임

### UDP는 기능이 없다!

**User Datagram Protocol - 사용자 데이터그램 프로토콜**

**하얀 도화지에 비유(기능이 거의 없음)
• 연결지향 - TCP 3 way handshake X
• 데이터 전달 보증 X
• 순서 보장 X
• 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름**

### **정리**

**`• IP와 거의 같다. +PORT +체크섬 정도만 추가`
• 애플리케이션에서 추가 작업 필요**

PORT → 어떤 용 Packet인지 구분하게 해줌

체크섬 → 이 메세지에 대해 정확히 맞는지 검증하는 데이터

UDP는 각광을 받는 이유가, TCP는 지금 이미 인터넷의 규약으로 되어 손댈 방도가 없다. 웹 브라우저에서 HTTP3 통신을 할 때, SYN → SYN+ACK → ACK 의 과정마저도 줄여보고 싶은 생각이 들었다. 그래서 요즘 뜨고 있다.