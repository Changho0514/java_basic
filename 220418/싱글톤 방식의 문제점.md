# ì‹±ê¸€í†¤ ë°©ì‹ì˜ ë¬¸ì œì 

<aside>
âœ…  ì‹±ê¸€í†¤ íŒ¨í„´ì´ë“ , ìŠ¤í”„ë§ ê°™ì€ ì‹±ê¸€í†¤ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ë“ , ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•˜ë‚˜ë§Œ ìƒì„±í•´ì„œ ê³µìœ í•˜ëŠ” ì‹±ê¸€í†¤ ë°©ì‹ì€ **ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ í•˜ë‚˜ì˜ ê°™ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ê¸° ë•Œë¬¸ì—** **ì‹±ê¸€í†¤ ê°ì²´ëŠ” ìƒíƒœë¥¼ ìœ ì§€(stateful)í•˜ê²Œ ì„¤ê³„í•˜ë©´ ì•ˆëœë‹¤.**

</aside>

- **ë¬´ìƒíƒœ(stateless)ë¡œ ì„¤ê³„í•´ì•¼ í•œë‹¤!**
    - íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ì— ì˜ì¡´ì ì¸ í•„ë“œê°€ ìˆìœ¼ë©´ ì•ˆëœë‹¤.
    - íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” í•„ë“œê°€ ìˆìœ¼ë©´ ì•ˆëœë‹¤!
    - ê°€ê¸‰ì  ì½ê¸°ë§Œ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.
    - í•„ë“œ ëŒ€ì‹ ì— ìë°”ì—ì„œ ê³µìœ ë˜ì§€ ì•ŠëŠ”, ì§€ì—­ë³€ìˆ˜, íŒŒë¼ë¯¸í„°, ThreadLocal ë“±ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
    
    **ğŸ”œì‹¤ë¬´ì—ì„œ êµ‰ì¥íˆ ë§ì´ ë‚˜ì˜¤ëŠ” ì‹¤ìˆ˜!!**
    
    ìƒíƒœë¥¼ ìœ ì§€í•  ê²½ìš° ë°œìƒí•˜ëŠ” ë¬¸ì œì  ì˜ˆì‹œ
    
    ```java
    package hello.core.singleton;
    public class StatefulService {
     private int price; //ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” í•„ë“œ
     public void order(String name, int price) {
     System.out.println("name = " + name + " price = " + price);
     this.price = price; //ì—¬ê¸°ê°€ ë¬¸ì œ!
     }
     public int getPrice() {
     return price;
     }
    }
    ```
    

Testë¥¼ ë§Œë“¤ë•Œ classëª… ìœ„ì— ì»¤ì„œë¥¼ ë†“ì€ì±„ë¡œ  `**Command + Shift + T`** ë‹¨ì¶•í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

![Untitled](%E1%84%89%E1%85%B5%E1%86%BC%E1%84%80%E1%85%B3%E1%86%AF%E1%84%90%E1%85%A9%E1%86%AB%20%20e3274/Untitled.png)

**testâ†’ hello.core.singleton.StatefulService**

```java
package hello.core.singleton;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.*;

class StatefulServiceTest {

    @Test
    void statefulServiceSingleton() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);
        StatefulService statefulService1 = ac.getBean(StatefulService.class);
        StatefulService statefulService2 = ac.getBean(StatefulService.class);

        // ThreadA: Aì‚¬ìš©ì 10000ì› ì£¼ë¬¸
        statefulService1.order("userA", 10000);

        //  ThreadB: Bì‚¬ìš©ì 20000ì› ì£¼ë¬¸
        statefulService2.order("userB", 20000);

        // ThreadA: ì‚¬ìš©ìA ì£¼ë¬¸ ê¸ˆì•¡ ì¡°íšŒ
        int price = statefulService1.getPrice();
        System.out.println("price = " + price);

        assertThat(statefulService1.getPrice()).isEqualTo(20000);
    }

    static class TestConfig {

        @Bean
        public StatefulService statefulService() {
            return new StatefulService();
        }
    }
}
```

**â‡’ ThreadAê°€ ì‚¬ìš©ì ì£¼ë¬¸ ê¸ˆì•¡ ì¡°íšŒ í•˜ë©´ 10000ì›ì´ ë‚˜ì™€ì•¼ í•˜ëŠ”ë° ê²°ê³¼ëŠ” 20000ì´ ë‚˜ì˜¨ë‹¤!**

ì‚¬ìš©ì Bê°€ Aì˜ ê²ƒë„ ë°”ê¾¸ì–´ë²„ë ¸ê¸° ë•Œë¬¸!

![Untitled](%E1%84%89%E1%85%B5%E1%86%BC%E1%84%80%E1%85%B3%E1%86%AF%E1%84%90%E1%85%A9%E1%86%AB%20%20e3274/Untitled%201.png)

ì´ ë¬¸ì œëŠ” **`this.price = price` ë•Œë¬¸ì— ë°œìƒí–ˆë‹¤!**

```java
public void order(String name, int price) {
        System.out.println("name = " + name + " price = " + price);
        this.price = price; //ì—¬ê¸°ê°€ ë¬¸ì œ!
    }
```

**orderì—ì„œ int price ê°€ ë“¤ì–´ì˜¤ë©´ priceë¥¼ ê°±ì‹  ì‹œí‚¤ëŠ”ê²ƒ!**

**ë‹¤ë¥¸ Thread ì—ì„œ ë“¤ì–´ì™”ëŠ”ë° stateë¥¼ ë³€ê²½ì‹œì¼œë²„ë ¸ë‹¤!**

## ì •ë¦¬

- ìµœëŒ€í•œ ë‹¨ìˆœíˆ ì„¤ëª…í•˜ê¸° ìœ„í•´, ì‹¤ì œ ì“°ë ˆë“œëŠ” ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‹¤. (ì‹¤ì œë¡œ ì“°ë ˆë“œ ì‚¬ìš©ì‹œ í›¨ì”¬ë” ë³µì¡í•œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤)
- ThreadAê°€ ì‚¬ìš©ìA ì½”ë“œë¥¼ í˜¸ì¶œí•˜ê³  ThreadBê°€ ì‚¬ìš©ìB ì½”ë“œë¥¼ í˜¸ì¶œí•œë‹¤ ê°€ì •í•˜ì.
- **StatefulService ì˜ price í•„ë“œëŠ” ê³µìœ ë˜ëŠ” í•„ë“œì¸ë°, íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ ê°’ì„ ë³€ê²½í•œë‹¤**
- ì‚¬ìš©ìAì˜ ì£¼ë¬¸ê¸ˆì•¡ì€ 10000ì›ì´ ë˜ì–´ì•¼ í•˜ëŠ”ë°, 20000ì›ì´ë¼ëŠ” ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤.
- ì‹¤ë¬´ì—ì„œ ì´ëŸ° ê²½ìš°ë¥¼ ì¢…ì¢… ë³´ëŠ”ë°, ì´ë¡œì¸í•´ ì •ë§ í•´ê²°í•˜ê¸° ì–´ë ¤ìš´ í° ë¬¸ì œë“¤ì´ í„°ì§„ë‹¤.(ëª‡ë…„ì— í•œë²ˆì”© ê¼­ ë§Œë‚œë‹¤.)
- **ì§„ì§œ ê³µìœ í•„ë“œëŠ” ì¡°ì‹¬í•´ì•¼ í•œë‹¤! ìŠ¤í”„ë§ ë¹ˆì€ í•­ìƒ ë¬´ìƒíƒœ(stateless)ë¡œ ì„¤ê³„í•˜ì.**